<script>
async function go() {
  const w = document.getElementById("wallet").value.trim();
  const r = document.getElementById("res"), s = document.getElementById("sh");
  r.textContent = "â³ Checking...";
  s.style.display = "none";

  try {
    const j = await fetch("/api/check", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ wallet: w })
    }).then(r => r.json());

    if (!j.success) {
      return r.textContent = "âŒ " + j.error;
    }

    const o = j.scores;
    const txt = `
ğŸ’¼ Wallet: ${o.address}
ğŸ’° Estimated Airdrop: ${o.estimated_u} $U

ğŸ“Š Score Breakdown:
â€¢ Volume: ${o.volume_score}
â€¢ Diversity: ${o.diversity_score}
â€¢ Interaction: ${o.interaction_score}
â€¢ Holding: ${o.holding_score}
â€¢ Cosmos Bonus: ${o.cosmos_bonus}
â€¢ Union Bonus: ${o.union_user_bonus}
    `;

    r.textContent = txt;

    // Create share link
    const shareText = `Just checked my potential $U airdrop on @unionbuild ğŸš€\nI might get ${o.estimated_u} $U!\nCheck yours here: https://union-airdrop-checker.onrender.com ğŸª‚`;
    const tweetLink = `https://twitter.com/intent/tweet?text=${encodeURIComponent(shareText)}`;

    const shareBtn = document.getElementById("shl");
    shareBtn.href = tweetLink;
    s.style.display = "block";

  } catch (e) {
    r.textContent = "âŒ Error checking eligibility";
    console.error(e);
  }
}
</script>
